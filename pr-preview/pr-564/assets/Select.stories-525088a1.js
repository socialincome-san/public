import{j as L,a as k,F as re,c as D}from"./index-83d39615.js";import{r as c,R as Q}from"./index-5ac02154.js";import{o as f,S as oe,D as V,y as A,T as Pe,u as E,l as U,h as Ce,a as De,b as ke,p as W,c as Ee,d as G,e as Fe,f as Ne,g as Ve,R as Ae,X as M,I as X,i as fe,s as Me,C as qe,j as _e,k as je,m as Be,n as w,q as y,r as ze,t as ee,x as Qe,v as He,w as Ue,z as We,A as Ge}from"./ChevronDownIcon-02a3726d.js";import"./_commonjsHelpers-725317a4.js";let le=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function ie(e){var a,l;let n=(a=e.innerText)!=null?a:"",r=e.cloneNode(!0);if(!(r instanceof HTMLElement))return n;let i=!1;for(let s of r.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))s.remove(),i=!0;let t=i?(l=r.innerText)!=null?l:"":n;return le.test(t)&&(t=t.replace(le,"")),t}function Ke(e){let a=e.getAttribute("aria-label");if(typeof a=="string")return a.trim();let l=e.getAttribute("aria-labelledby");if(l){let n=l.split(" ").map(r=>{let i=document.getElementById(r);if(i){let t=i.getAttribute("aria-label");return typeof t=="string"?t.trim():ie(i).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return ie(e).trim()}function Xe(e){let a=c.useRef(""),l=c.useRef("");return f(()=>{let n=e.current;if(!n)return"";let r=n.innerText;if(a.current===r)return l.current;let i=Ke(n).trim().toLowerCase();return a.current=r,l.current=i,i})}var Je=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Je||{}),Ye=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Ye||{}),Ze=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Ze||{}),et=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.RegisterLabel=7]="RegisterLabel",e))(et||{});function Z(e,a=l=>l){let l=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,n=He(a(e.options.slice()),i=>i.dataRef.current.domRef.current),r=l?n.indexOf(l):null;return r===-1&&(r=null),{options:n,activeOptionIndex:r}}let tt={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let a=e.activeOptionIndex,{isSelected:l}=e.dataRef.current,n=e.options.findIndex(r=>l(r.dataRef.current.value));return n!==-1&&(a=n),{...e,listboxState:0,activeOptionIndex:a}},2(e,a){var l;if(e.dataRef.current.disabled||e.listboxState===1)return e;let n=Z(e),r=Qe(a,{resolveItems:()=>n.options,resolveActiveIndex:()=>n.activeOptionIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled});return{...e,...n,searchQuery:"",activeOptionIndex:r,activationTrigger:(l=a.trigger)!=null?l:1}},3:(e,a)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let l=e.searchQuery!==""?0:1,n=e.searchQuery+a.value.toLowerCase(),r=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+l).concat(e.options.slice(0,e.activeOptionIndex+l)):e.options).find(t=>{var s;return!t.dataRef.current.disabled&&((s=t.dataRef.current.textValue)==null?void 0:s.startsWith(n))}),i=r?e.options.indexOf(r):-1;return i===-1||i===e.activeOptionIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeOptionIndex:i,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,a)=>{let l={id:a.id,dataRef:a.dataRef},n=Z(e,r=>[...r,l]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(a.dataRef.current.value)&&(n.activeOptionIndex=n.options.indexOf(l)),{...e,...n}},6:(e,a)=>{let l=Z(e,n=>{let r=n.findIndex(i=>i.id===a.id);return r!==-1&&n.splice(r,1),n});return{...e,...l,activationTrigger:1}},7:(e,a)=>({...e,labelId:a.id})},te=c.createContext(null);te.displayName="ListboxActionsContext";function q(e){let a=c.useContext(te);if(a===null){let l=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,q),l}return a}let ne=c.createContext(null);ne.displayName="ListboxDataContext";function _(e){let a=c.useContext(ne);if(a===null){let l=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,_),l}return a}function nt(e,a){return E(a.type,tt,e,a)}let at=c.Fragment;function rt(e,a){let{value:l,defaultValue:n,form:r,name:i,onChange:t,by:s=(u,d)=>u===d,disabled:v=!1,horizontal:g=!1,multiple:h=!1,...O}=e;const $=g?"horizontal":"vertical";let T=A(a),[S=h?[]:void 0,p]=Pe(l,t,n),[m,o]=c.useReducer(nt,{dataRef:c.createRef(),listboxState:1,options:[],searchQuery:"",labelId:null,activeOptionIndex:null,activationTrigger:1}),b=c.useRef({static:!1,hold:!1}),C=c.useRef(null),j=c.useRef(null),J=c.useRef(null),R=f(typeof s=="string"?(u,d)=>{let I=s;return(u==null?void 0:u[I])===(d==null?void 0:d[I])}:s),P=c.useCallback(u=>E(x.mode,{1:()=>S.some(d=>R(d,u)),0:()=>R(S,u)}),[S]),x=c.useMemo(()=>({...m,value:S,disabled:v,mode:h?1:0,orientation:$,compare:R,isSelected:P,optionsPropsRef:b,labelRef:C,buttonRef:j,optionsRef:J}),[S,v,h,m]);U(()=>{m.dataRef.current=x},[x]),Ce([x.buttonRef,x.optionsRef],(u,d)=>{var I;o({type:1}),De(d,ke.Loose)||(u.preventDefault(),(I=x.buttonRef.current)==null||I.focus())},x.listboxState===0);let me=c.useMemo(()=>({open:x.listboxState===0,disabled:v,value:S}),[x,v,S]),xe=f(u=>{let d=x.options.find(I=>I.id===u);d&&Y(d.dataRef.current.value)}),ge=f(()=>{if(x.activeOptionIndex!==null){let{dataRef:u,id:d}=x.options[x.activeOptionIndex];Y(u.current.value),o({type:2,focus:w.Specific,id:d})}}),he=f(()=>o({type:0})),Se=f(()=>o({type:1})),ye=f((u,d,I)=>u===w.Specific?o({type:2,focus:w.Specific,id:d,trigger:I}):o({type:2,focus:u,trigger:I})),Oe=f((u,d)=>(o({type:5,id:u,dataRef:d}),()=>o({type:6,id:u}))),Re=f(u=>(o({type:7,id:u}),()=>o({type:7,id:null}))),Y=f(u=>E(x.mode,{0(){return p==null?void 0:p(u)},1(){let d=x.value.slice(),I=d.findIndex(z=>R(z,u));return I===-1?d.push(u):d.splice(I,1),p==null?void 0:p(d)}})),Ie=f(u=>o({type:3,value:u})),Le=f(()=>o({type:4})),we=c.useMemo(()=>({onChange:Y,registerOption:Oe,registerLabel:Re,goToOption:ye,closeListbox:Se,openListbox:he,selectActiveOption:ge,selectOption:xe,search:Ie,clearSearch:Le}),[]),Te={ref:T},B=c.useRef(null),$e=W();return c.useEffect(()=>{B.current&&n!==void 0&&$e.addEventListener(B.current,"reset",()=>{p==null||p(n)})},[B,p]),Q.createElement(te.Provider,{value:we},Q.createElement(ne.Provider,{value:x},Q.createElement(Ee,{value:E(x.listboxState,{0:G.Open,1:G.Closed})},i!=null&&S!=null&&Fe({[i]:S}).map(([u,d],I)=>Q.createElement(Ne,{features:Ve.Hidden,ref:I===0?z=>{var ae;B.current=(ae=z==null?void 0:z.closest("form"))!=null?ae:null}:void 0,...Ae({key:u,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:r,name:u,value:d})})),M({ourProps:Te,theirProps:O,slot:me,defaultTag:at,name:"Listbox"}))))}let ot="button";function lt(e,a){var l;let n=X(),{id:r=`headlessui-listbox-button-${n}`,...i}=e,t=_("Listbox.Button"),s=q("Listbox.Button"),v=A(t.buttonRef,a),g=W(),h=f(m=>{switch(m.key){case y.Space:case y.Enter:case y.ArrowDown:m.preventDefault(),s.openListbox(),g.nextFrame(()=>{t.value||s.goToOption(w.First)});break;case y.ArrowUp:m.preventDefault(),s.openListbox(),g.nextFrame(()=>{t.value||s.goToOption(w.Last)});break}}),O=f(m=>{switch(m.key){case y.Space:m.preventDefault();break}}),$=f(m=>{if(ze(m.currentTarget))return m.preventDefault();t.listboxState===0?(s.closeListbox(),g.nextFrame(()=>{var o;return(o=t.buttonRef.current)==null?void 0:o.focus({preventScroll:!0})})):(m.preventDefault(),s.openListbox())}),T=fe(()=>{if(t.labelId)return[t.labelId,r].join(" ")},[t.labelId,r]),S=c.useMemo(()=>({open:t.listboxState===0,disabled:t.disabled,value:t.value}),[t]),p={ref:v,id:r,type:Me(e,t.buttonRef),"aria-haspopup":"listbox","aria-controls":(l=t.optionsRef.current)==null?void 0:l.id,"aria-expanded":t.listboxState===0,"aria-labelledby":T,disabled:t.disabled,onKeyDown:h,onKeyUp:O,onClick:$};return M({ourProps:p,theirProps:i,slot:S,defaultTag:ot,name:"Listbox.Button"})}let it="label";function st(e,a){let l=X(),{id:n=`headlessui-listbox-label-${l}`,...r}=e,i=_("Listbox.Label"),t=q("Listbox.Label"),s=A(i.labelRef,a);U(()=>t.registerLabel(n),[n]);let v=f(()=>{var h;return(h=i.buttonRef.current)==null?void 0:h.focus({preventScroll:!0})}),g=c.useMemo(()=>({open:i.listboxState===0,disabled:i.disabled}),[i]);return M({ourProps:{ref:s,id:n,onClick:v},theirProps:r,slot:g,defaultTag:it,name:"Listbox.Label"})}let ut="ul",ct=oe.RenderStrategy|oe.Static;function dt(e,a){var l;let n=X(),{id:r=`headlessui-listbox-options-${n}`,...i}=e,t=_("Listbox.Options"),s=q("Listbox.Options"),v=A(t.optionsRef,a),g=W(),h=W(),O=qe(),$=(()=>O!==null?(O&G.Open)===G.Open:t.listboxState===0)();c.useEffect(()=>{var o;let b=t.optionsRef.current;b&&t.listboxState===0&&b!==((o=_e(b))==null?void 0:o.activeElement)&&b.focus({preventScroll:!0})},[t.listboxState,t.optionsRef]);let T=f(o=>{switch(h.dispose(),o.key){case y.Space:if(t.searchQuery!=="")return o.preventDefault(),o.stopPropagation(),s.search(o.key);case y.Enter:if(o.preventDefault(),o.stopPropagation(),t.activeOptionIndex!==null){let{dataRef:b}=t.options[t.activeOptionIndex];s.onChange(b.current.value)}t.mode===0&&(s.closeListbox(),ee().nextFrame(()=>{var b;return(b=t.buttonRef.current)==null?void 0:b.focus({preventScroll:!0})}));break;case E(t.orientation,{vertical:y.ArrowDown,horizontal:y.ArrowRight}):return o.preventDefault(),o.stopPropagation(),s.goToOption(w.Next);case E(t.orientation,{vertical:y.ArrowUp,horizontal:y.ArrowLeft}):return o.preventDefault(),o.stopPropagation(),s.goToOption(w.Previous);case y.Home:case y.PageUp:return o.preventDefault(),o.stopPropagation(),s.goToOption(w.First);case y.End:case y.PageDown:return o.preventDefault(),o.stopPropagation(),s.goToOption(w.Last);case y.Escape:return o.preventDefault(),o.stopPropagation(),s.closeListbox(),g.nextFrame(()=>{var b;return(b=t.buttonRef.current)==null?void 0:b.focus({preventScroll:!0})});case y.Tab:o.preventDefault(),o.stopPropagation();break;default:o.key.length===1&&(s.search(o.key),h.setTimeout(()=>s.clearSearch(),350));break}}),S=fe(()=>{var o,b,C;return(C=(o=t.labelRef.current)==null?void 0:o.id)!=null?C:(b=t.buttonRef.current)==null?void 0:b.id},[t.labelRef.current,t.buttonRef.current]),p=c.useMemo(()=>({open:t.listboxState===0}),[t]),m={"aria-activedescendant":t.activeOptionIndex===null||(l=t.options[t.activeOptionIndex])==null?void 0:l.id,"aria-multiselectable":t.mode===1?!0:void 0,"aria-labelledby":S,"aria-orientation":t.orientation,id:r,onKeyDown:T,role:"listbox",tabIndex:0,ref:v};return M({ourProps:m,theirProps:i,slot:p,defaultTag:ut,features:ct,visible:$,name:"Listbox.Options"})}let pt="li";function bt(e,a){let l=X(),{id:n=`headlessui-listbox-option-${l}`,disabled:r=!1,value:i,...t}=e,s=_("Listbox.Option"),v=q("Listbox.Option"),g=s.activeOptionIndex!==null?s.options[s.activeOptionIndex].id===n:!1,h=s.isSelected(i),O=c.useRef(null),$=Xe(O),T=je({disabled:r,value:i,domRef:O,get textValue(){return $()}}),S=A(a,O);U(()=>{if(s.listboxState!==0||!g||s.activationTrigger===0)return;let R=ee();return R.requestAnimationFrame(()=>{var P,x;(x=(P=O.current)==null?void 0:P.scrollIntoView)==null||x.call(P,{block:"nearest"})}),R.dispose},[O,g,s.listboxState,s.activationTrigger,s.activeOptionIndex]),U(()=>v.registerOption(n,T),[T,n]);let p=f(R=>{if(r)return R.preventDefault();v.onChange(i),s.mode===0&&(v.closeListbox(),ee().nextFrame(()=>{var P;return(P=s.buttonRef.current)==null?void 0:P.focus({preventScroll:!0})}))}),m=f(()=>{if(r)return v.goToOption(w.Nothing);v.goToOption(w.Specific,n)}),o=Be(),b=f(R=>o.update(R)),C=f(R=>{o.wasMoved(R)&&(r||g||v.goToOption(w.Specific,n,0))}),j=f(R=>{o.wasMoved(R)&&(r||g&&v.goToOption(w.Nothing))}),J=c.useMemo(()=>({active:g,selected:h,disabled:r}),[g,h,r]);return M({ourProps:{id:n,ref:S,role:"option",tabIndex:r===!0?void 0:-1,"aria-disabled":r===!0?!0:void 0,"aria-selected":h,disabled:void 0,onClick:p,onFocus:m,onPointerEnter:b,onMouseEnter:b,onPointerMove:C,onMouseMove:C,onPointerLeave:j,onMouseLeave:j},theirProps:t,slot:J,defaultTag:pt,name:"Listbox.Option"})}let ft=V(rt),vt=V(lt),mt=V(st),xt=V(dt),gt=V(bt),F=Object.assign(ft,{Button:vt,Label:mt,Options:xt,Option:gt});const ht=["base","xl"],K=({label:e,options:a,name:l,size:n="base",selected:r=Object.keys(a)[0],block:i=!1,labelHidden:t=!1,...s})=>L(F,{...s,children:({open:v})=>{var g,h,O,$,T;return k(re,{children:[L(F.Label,{className:D("block","font-medium","text-gray-700","mb-1",{"sr-only":t}),children:e}),k("div",{className:"relative",children:[k(F.Button,{className:D("relative","cursor-default","rounded-lg","border","border-gray-300","bg-white","p-3","pl-3","pr-10","text-left","transition","hover:shadow-lg","hover:shadow-gray-200",`text-${n}`,{"w-full":i}),children:[k("span",{className:"flex items-center",children:[((g=a[r])==null?void 0:g.image)&&L("img",{src:(O=(h=a[r])==null?void 0:h.image)==null?void 0:O.src,alt:"",className:"h-6 w-6 flex-shrink-0 rounded-full object-cover"}),L("span",{className:D({"ml-3":!!(($=a[r])!=null&&$.image)},"block","truncate"),children:(T=a[r])==null?void 0:T.label})]}),L("span",{className:"pointer-events-none absolute inset-y-0 right-0 ml-2 flex items-center pr-2",children:L(Ue,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),L(We,{show:v,as:c.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:L(F.Options,{className:D("absolute","z-10","mt-1","max-h-56","overflow-auto","rounded-lg","bg-white","py-1","shadow-lg","ring-1","ring-black","ring-opacity-5","focus:outline-none",`text-${n}`,{"w-full":i}),children:Object.entries(a).map(([S,p],m)=>L(F.Option,{className:({active:o})=>D(o?"bg-so-color-accent-2-primary-500 text-white":"text-gray-900","relative cursor-default select-none py-2 pl-3 pr-12"),value:S,children:({selected:o,active:b})=>k(re,{children:[k("div",{className:"flex items-center",children:[(p==null?void 0:p.image)&&L("img",{src:p.image.src,alt:"",className:"h-6 w-6 flex-shrink-0 rounded-full object-cover"}),L("span",{className:D(b?"font-semibold":"font-normal","truncate",{"ml-3":!!(p!=null&&p.image)}),children:p.label})]}),o&&L("span",{className:D("absolute inset-y-0 right-0 flex items-center pr-4"),children:L(Ge,{className:"h-5 w-5","aria-hidden":"true"})})]})},m))})})]})]})}});try{K.displayName="SoSelect",K.__docgenInfo={description:"",displayName:"SoSelect",props:{label:{defaultValue:null,description:"The select's label elements",name:"label",required:!0,type:{name:"string"}},options:{defaultValue:null,description:"Options available for selection",name:"options",required:!0,type:{name:"Record<string, SoSelectItem>"}},selected:{defaultValue:{value:"Object.keys(options)[0]"},description:"The selected/current value",name:"selected",required:!1,type:{name:"string"}},block:{defaultValue:{value:"false"},description:"Render full width",name:"block",required:!1,type:{name:"boolean"}},labelHidden:{defaultValue:{value:"false"},description:"If true, the label is visually hidden. It will still be available to screenreaders.",name:"labelHidden",required:!1,type:{name:"boolean"}},size:{defaultValue:{value:"base"},description:"Visual size of the button",name:"size",required:!1,type:{name:"enum",value:[{value:'"base"'},{value:'"xl"'}]}},onChange:{defaultValue:null,description:"Emits the selected value on change",name:"onChange",required:!1,type:{name:"(value: string) => void"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"unknown"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}}}}}catch{}const It={component:K,argTypes:{block:{defaultValue:!1,description:"If true, the control will be rendered with 100% width",control:{type:"boolean"}},labelHidden:{defaultValue:!1,description:"If true, the label is only available to screenreaders, but visually hidden.",control:{type:"boolean"}},size:{defaultValue:"base",options:ht,control:{type:"select"}}}},ve=e=>{const a=(e==null?void 0:e.options)||{"option-1":{label:"Option 1",value:"option-1"},"option-2":{label:"Option 2",value:"option-2"},"option-3":{label:"Option 3",value:"option-3"}},[l,n]=c.useState("option-1"),r={label:"Select Label",selected:l,options:a,...e,onChange:i=>{n(i)}};return L(K,{...r})},H=ve.bind({}),N=ve.bind({});N.args={label:"Country Selector Example",options:{"option-1":{label:"Option 1",value:"option-1",image:{src:"ch.svg"}},"option-2":{label:"Option 2",value:"option-2",image:{src:"ch.svg"}},"option-3":{label:"Option 3",value:"option-3",image:{src:"ch.svg"}}}};var se,ue,ce;H.parameters={...H.parameters,docs:{...(se=H.parameters)==null?void 0:se.docs,source:{originalSource:`(args: Partial<SoSelectProps>) => {
  const options: SoSelectProps['options'] = args?.options || {
    'option-1': {
      label: 'Option 1',
      value: 'option-1'
    },
    'option-2': {
      label: 'Option 2',
      value: 'option-2'
    },
    'option-3': {
      label: 'Option 3',
      value: 'option-3'
    }
  };
  const [value, setValue] = useState('option-1');
  const props: SoSelectProps = {
    label: 'Select Label',
    selected: value,
    options,
    ...args,
    onChange: selectedItem => {
      setValue(selectedItem);
    }
  };
  return <SoSelect {...props} />;
}`,...(ce=(ue=H.parameters)==null?void 0:ue.docs)==null?void 0:ce.source}}};var de,pe,be;N.parameters={...N.parameters,docs:{...(de=N.parameters)==null?void 0:de.docs,source:{originalSource:`(args: Partial<SoSelectProps>) => {
  const options: SoSelectProps['options'] = args?.options || {
    'option-1': {
      label: 'Option 1',
      value: 'option-1'
    },
    'option-2': {
      label: 'Option 2',
      value: 'option-2'
    },
    'option-3': {
      label: 'Option 3',
      value: 'option-3'
    }
  };
  const [value, setValue] = useState('option-1');
  const props: SoSelectProps = {
    label: 'Select Label',
    selected: value,
    options,
    ...args,
    onChange: selectedItem => {
      setValue(selectedItem);
    }
  };
  return <SoSelect {...props} />;
}`,...(be=(pe=N.parameters)==null?void 0:pe.docs)==null?void 0:be.source}}};const Lt=["Standard","WithImages"];export{H as Standard,N as WithImages,Lt as __namedExportsOrder,It as default};
//# sourceMappingURL=Select.stories-525088a1.js.map
